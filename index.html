<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="stylesheet" type="text/css" href="css/index.css">
</head>

<body>

  <script type="text/javascript" src="js/base/jquery.min.js"></script>
  <script type="text/javascript" src="js/base/jQuery.print.js"></script>
  <script type="text/javascript" src="js/base/jquery.base64.js"></script>
  <script type="text/javascript" src="js/libs/FileSaver/FileSaver.min.js"></script>
  <!--
<script type="text/javascript" src="js/libs/jsPDF/jspdf.min.js"></script>
<script type="text/javascript" src="js/libs/jsPDF-AutoTable/jspdf.plugin.autotable.js"></script>
<script type="text/javascript" src="js/pdfmake/pdfmake.js"></script>
<script type="text/javascript" src="js/pdfmake/vfs_fonts.js"></script>
-->
  <script type="text/javascript" src="js/base/tableExport.js"></script>

  <script type="text/javascript" src="js/generate/layout.js"></script>
  <script type="text/javascript" src="js/generate/exercise.js"></script>
  <script type="text/javascript" src="js/calculate/rand.js"></script>
  <script type="text/javascript" src="js/calculate/modes.js"></script>
  <script type="text/javascript" src="js/calculate/integerAdd.js"></script>
  <script type="text/javascript" src="js/calculate/integerSub.js"></script>
  <script type="text/javascript" src="js/calculate/integerMul.js"></script>
  <script type="text/javascript" src="js/calculate/integerMix.js"></script>

  <script type="text/javascript">

    var modes = calculateModes;

    /* randomly generate one issue of give type */
    function generate_issue (type) {
      var i, j;

      var issue = new Object();

      // default 1 operator
      issue.op_n = 1;
      issue.op = new Array();
      issue.opr = new Array();

      switch (type) {
        case 'add_1_1':
          issue = add_1_1(issue);
          break;

        case 'mix_20':
          issue = mix_20(issue);
          break;

        case 'abdicate_20':
          issue = abdicate_20(issue);
          break;

        case 'addc_2_2':
          issue = addc_2_2(issue);
          break;

        case 'add_2_2':
          issue = add_2_2(issue);
          break;

        case 'subc_2_2':
          issue = subc_2_2(issue);
          break;

        case 'sub_2_2':
          issue = sub_2_2(issue);
          break;

        case 'add_1_2':
          issue = add_1_2(issue);
          break;

        case 'add_2_1':
          issue = add_2_1(issue);
          break;

        case 'sub_2_1':
          issue = sub_2_1(issue);
          break;

        case 'addc_2_2_100':
          issue = addc_2_2_100(issue);
          break;
        case 'add_2_1_100':
          issue = add_2_1_100(issue);
          break;

        case 'sub_100_1':
          issue = sub_100_1(issue);
          break;

        case 'sub_100_2':
          issue = sub_100_2(issue);
          break;

        case 'add_cont_100':
          issue = add_cont_100(issue);
          break;

        case 'sub_cont_100':
          issue = sub_cont_100(issue);
          break;

        case 'add_sub_cont_100':
          issue = add_sub_cont_100(issue);
          break;

        case 'sub_add_cont_100':
          issue = sub_add_cont_100(issue);
          break;

        case 'mul_1_1':
          issue = mul_1_1(issue);
          break;

        case 'addmul_2_1_1':
          issue = addmul_2_1_1(issue);
          break;

        case 'submul_2_1_1':
          issue = submul_2_1_1(issue);
          break;

        case 'muladd_1_1_2':
          issue = muladd_1_1_2(issue);
          break;

        case 'mulsub_1_1_2':
          issue = mulsub_1_1_2(issue);
          break;

        case 'sub9':
          issue = sub9(issue);
          break;

        case 'sub012':
          issue = sub012(issue);
          break;

        case 'add012':
          issue = add012(issue);
          break;

        case 'mix_2_1':
          issue = mix_2_1(issue);
          break;

        case 'addn_2_2':
          issue = addn_2_2(issue);
          break;

        default:
          alert("unknown type=" + type);
      }
      return issue;
    }

    /* store all generated issues. Maximum pages * cells per page/table */
    var MAX_PAGES = 20;
    var CELLS_PER_PAGE = 50;
    var cells = new Array(MAX_PAGES * CELLS_PER_PAGE);

    /* which op mode we are in:
       0: specify type for each column
       1: specify quantity of each type then mix
    */
    var current_mode = 0;
    /* how many page generated, user can choose between 1-MAX_PAGES */
    var old_total_pages = 0;
    var total_pages = 0;


    window.onload = function () {
      changetab();
      create_options();
      generate(50);
      document.getElementById("btn50").style.display = "inline";
      document.getElementById("btn100").style.display = "inline";
      document.getElementById("btnmix").style.display = "none";
    }

    function printme () {
      $("#tabdiv").print();
    }

    function saveasword () {
      $("table").tableExport({ type: 'doc', escape: 'false', excelstyles: ['height', 'width', 'text-align', 'font-size', 'align'] });
    }

    function saveaspdf () {
      $("table").tableExport({ type: 'pdf', fileName: 'issues', pdfmake: { enabled: true } });
    }

  </script>

  <center>
    <h2 id="tab">
      <span class="tab">按列选模式生成</span>
      <span>按模式数量混合生成</span>
    </h2>
  </center>

  <div id="ct" align="center">
    <div class="ct">
      <ul>
        <li class="colmode">第1列: <select id="col1type"></select></li>

        <li class="colmode">第2列: <select id="col2type"></select></li>

        <li class="colmode">第3列: <select id="col3type"></select></li>

        <li class="colmode">第4列: <select id="col4type"></select></li>

        <li class="colmode">第5列: <select id="col5type"></select></li>
      </ul>
    </div>
    <div>
      <ul id="mode_option_list"> </ul>
    </div>
  </div>
  <div id="act" align="center">
    <div class="act" align="center">
      <input id="btn50" type="button" value="重新生成50题" onclick="generate(50)" />
      <input id="btn100" type="button" value="重新生成100题" onclick="generate(100)" />
      <input id="btnmix" type="button" value="重新生成" onclick="generate(100)" />
      <input type="text" value="1" id="pages" size="2" />份
      <input type="button" value="打印习题" onclick="printme()" />
      <input type="button" value="另存为word" onclick="saveasword()" />

      <!-- <input type="button" value="另存为pdf" onclick="saveaspdf()" /> -->

      <input type="checkbox" id="show_answer_cb" value="answer" onclick="show_issues()" />显示答案
    </div>
  </div>


  <div id="tabdiv" class="print_section" align="center" width="100%">
  </div>
</body>

</html>